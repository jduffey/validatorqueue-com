import pytest

from build import calculate_wait_time


scaling = [0, 327680, 393216, 458752, 524288, 589824, 655360, 720896, 786432, 851968, 917504, 983040, 1048576, 1114112, 1179648, 1245184, 1310720, 1376256, 1441792, 1507328,
           1572864, 1638400, 1703936, 1769472, 1835008, 1900544, 1966080, 2031616, 2097152, 2162688, 2228224, 2293760, 2359296, 2424832, 2490368, 2555904, 2621440, 2686976, 2752512]


@pytest.mark.parametrize("validator_count, expected", [
    [0, ('14 minutes', 0.01, 9, 4.0, 0.01)],
    [327680, ('13 minutes', 0.008888888888888889, 4, 5.0, 0.008888888888888889)],
    [393216, ('11 minutes', 0.007407407407407408, 5, 6.0, 0.007407407407407408)],
    [458752, ('9 minutes', 0.006354166666666667, 6, 7.0, 0.006349206349206349)],
    [524288, ('8 minutes', 0.005555555555555556, 7, 8.0, 0.005555555555555556)],
    [589824, ('7 minutes', 0.00494212962962963, 8, 9.0, 0.0049382716049382715)],
])
def test_calculate_wait_time(validator_count, expected):
    queue_length = 10

    actual = calculate_wait_time(validator_count, queue_length)

    assert actual == expected
